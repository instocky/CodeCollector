# 📁 CodeCollector - Сборщик кода в один файл

Мощный Python инструмент для быстрого сбора файлов проекта в `collected_files.md` с интерактивным выбором и умной фильтрацией. Подготовка файлов проекта - для передачи в LLM.

## 🚀 Ключевые возможности

- ✅ **Мгновенный запуск** - сразу дерево файлов без лишних вопросов
- ✅ **Память проекта** - запоминает выбор файлов и настройки
- ✅ **Интерактивное дерево** - навигация с галочками и контекстом
- ✅ **Автофильтрация** - .gitignore + служебные папки
- ✅ **Сохранение контекста** - видно проект и настройки в дереве
- ✅ **Markdown + структура** - всегда красивый результат

## 🛠 Установка

```bash
git clone https://github.com/instocky/codecollector.git
cd codecollector
pip install -e .

# Команда доступна глобально
codecollector --help
```

## ⚡ Быстрый старт

### Первый раз в проекте
```bash
cd my-project
codecollector
# → 2 вопроса (сортировка + интерактивный) → дерево → готово
```

### Повторные запуски  
```bash
codecollector
# → 0 вопросов → сразу дерево → готово
```

**Результат:** всегда `collected_files.md` в Markdown формате со структурой проекта

## 🎮 Интерактивное дерево (новый UI)

```
🚀 CodeCollector
==============================
✅ Рабочая директория: /my-project
🔄 Проект 'my-project' | по времени + интерактивный

╔═══════════════════════════════════════════════════════════════════════════════╗
║  ВЫБОР ФАЙЛОВ (15/89 файлов выбрано)                                        ║
║  Страница 1/3                                                               ║
╠═══════════════════════════════════════════════════════════════════════════════╣
║  ↑↓ - навигация, SPACE - выбор, →← - развернуть/свернуть                    ║
║  A/N - всё/ничего, +/- - развернуть/свернуть все, R - сброс, Q - выход      ║
╚═══════════════════════════════════════════════════════════════════════════════╝

→ 📁 ☑ ▼ src/ (23 файла)
  📄 ☑   UserController.php
  📄 ☐   ProductController.php
📁 ☐ ▶ tests/ (12 файлов)
📄 ☑ README.md

Выбрано: 15 файлов
Текущий: src/UserController.php
```

### Новые UI/UX улучшения:
- 🔥 **Сохранение контекста** - проект и настройки видны в дереве
- ⚡ **Мгновенный запуск** - убраны все промежуточные сообщения  
- 🎯 **Клавиша R** - быстрый сброс всего выбора
- 📦 **Компактный дизайн** - больше файлов на экране
- 💾 **Восстановление выбора** - помнит предыдущий выбор файлов

## 🔧 Флаги управления

```bash
codecollector                # Основной режим (первый раз настройка, потом сразу дерево)
codecollector --setup       # Перенастроить проект заново
codecollector --quick       # Все файлы без интерактивного выбора
codecollector --reset       # Сбросить настройки проекта
codecollector -r            # Удаленный режим (спросить директорию)
```

## 🧠 Память проекта

Автоматически сохраняет в `.codecollector/{project_name}.json`:
- ✅ Выбранные файлы и папки
- ✅ Настройки сортировки и режима
- ✅ Восстанавливает при повторном запуске

```bash
# Первый запуск
codecollector  # → настройка → дерево → сохранение

# Все последующие 
codecollector  # → сразу дерево с прошлым выбором
```

## 📊 Сценарии использования

| Команда                 | Частота | Назначение          |
| ----------------------- | ------- | ------------------- |
| `codecollector`         | 90%     | Ежедневная работа   |
| `codecollector --quick` | 8%      | Быстрый полный сбор |
| `codecollector --setup` | 2%      | Смена настроек      |

## 🎯 Что нового в UI/UX

### ✅ Реализовано
- **Мгновенный переход к дереву** - убраны все лишние промпты
- **Контекст в дереве** - всегда видно проект и настройки  
- **Клавиша R для сброса** - быстрая очистка выбора
- **Жесткий формат вывода** - всегда `collected_files.md`
- **Умные режимы** - первый раз настройка, потом скорость

### 🔥 В разработке
- **Предпросмотр файлов** - клавиша V для просмотра содержимого
- **ASCII режим** - поддержка старых терминалов Windows
- **Цветовая схема** - подсветка типов файлов

## 🚀 Технические детали

**Фильтрация:** .gitignore + служебные папки (node_modules, __pycache__, .git)  
**Форматы:** 40+ языков программирования с подсветкой синтаксиса  
**Кодировки:** UTF-8 → CP1251 fallback  
**Платформы:** Windows, Linux, macOS  

## 🐛 Проблемы

- **Unicode символы в CMD:** используйте Windows Terminal или --ascii-mode
- **Стрелки не работают:** альтернативы W/S, J/K
- **Пустой результат:** проверьте .gitignore настройки

## 📈 Примеры

```bash
# Laravel проект
cd ~/laravel-app && codecollector
# → настроили один раз → потом всегда быстро

# React проект  
cd ~/react-app && codecollector --setup
# → переопределить настройки

# Быстрый сбор всего
codecollector --quick
# → все файлы без выбора
```

---

**🎯 Философия:** Первый раз настройка, потом максимальная скорость  
**📄 Результат:** всегда `collected_files.md` с подсветкой синтаксиса  
**💾 Память:** помнит ваши предпочтения для каждого проекта