# 📁 CodeCollector - Сборщик кода в один файл

Мощный Python скрипт для сбора всех файлов проекта в один текстовый файл с поддержкой интерактивного выбора, иерархической структуры папок и умной фильтрации.

## 🚀 Возможности

- ✅ **Автоматическая фильтрация** - исключает служебные папки и файлы
- ✅ **Поддержка .gitignore** - автоматически исключает файлы по паттернам
- ✅ **Интерактивный выбор** - красивый интерфейс с галочками
- ✅ **Иерархическое дерево** - навигация по папкам и файлам
- ✅ **Сортировка по времени** - новые файлы сверху
- ✅ **Поиск файлов** - быстрый поиск по имени
- ✅ **Кроссплатформенность** - работает на Windows, Linux, Mac

## 📋 Требования

- Python 3.6+
- Стандартные библиотеки (pathlib, fnmatch, termios/msvcrt)

## 🛠 Установка

1. Скачайте CodeCollector (`main.py`)
2. Сделайте его исполняемым (Linux/Mac):
   ```bash
   chmod +x main.py
   ```

## 💻 Использование

### Базовые команды

```bash
# Простой запуск CodeCollector
python main.py

# Указать директорию и выходной файл
python main.py /path/to/project output.txt

# Интерактивный режим
python main.py -i

# Сортировка по времени изменения
python main.py -t

# Комбинация флагов
python main.py -i -t /path/to/project collected_code.txt
```

### Флаги командной строки

| Флаг                          | Описание                        |
| ----------------------------- | ------------------------------- |
| `-i`, `--interactive`         | Интерактивный выбор файлов      |
| `-t`, `--time`, `--sort-time` | Сортировка по времени изменения |

## 🎮 Управление в интерактивном режиме

### Навигация
- **↑↓** / **W/S** / **J/K** - навигация по списку
- **→** - развернуть папку
- **←** - свернуть папку
- **SPACE** - выбрать/отменить файл или папку

### Быстрые действия
- **A** - выбрать все файлы
- **N** - снять все выборы
- **+** - развернуть все папки
- **-** - свернуть все папки
- **F** - поиск файла по имени

### Завершение
- **ENTER** - подтвердить выбор и продолжить
- **Q** / **ESC** - выйти без сохранения

## 📁 Что исключается автоматически

### Служебные папки
- `vendor/` (Composer)
- `node_modules/` (npm)
- `venv/`, `env/` (Python virtual env)
- `.git/` (Git)
- `.vscode/` (VS Code)
- `__pycache__/` (Python cache)

### Служебные файлы
- `.env*` (переменные окружения)
- `*.pyc`, `*.pyo` (Python cache)
- `*.log` (логи)
- `.DS_Store` (macOS)
- `.gitignore`

### Файлы из .gitignore
Скрипт автоматически читает `.gitignore` и исключает все указанные в нем паттерны.

## 📊 Интерфейс CodeCollector CodeCollector

### Обычный режим
```
CodeCollector: Сканирование директории /home/user/project
Загружено паттернов из .gitignore: 8
Сортировка по времени изменения (новые сверху)...
Найдено файлов: 45
Готово! Результат сохранен в: output.txt
```

### Интерактивный режим
```
╔════════════════════════════════════════════════════════════════════════════════╗
║  ВЫБОР ФАЙЛОВ И ПАПОК (15/89 файлов выбрано)                                  ║
║  Страница 1/5 | Сортировка: по времени (новые ↑)                              ║
╠════════════════════════════════════════════════════════════════════════════════╣
║  ↑↓ - навигация, SPACE - выбор, →← - развернуть/свернуть                       ║
║  A/N - всё/ничего, +/- - развернуть/свернуть все, F - поиск, Q - выход        ║
╚════════════════════════════════════════════════════════════════════════════════╝

→ 📁 ☑ src/ (12 файлов) [28.05 14:32]
  📁 ◑ ▼ controllers/ (8 файлов)
    📄 ☑   UserController.php [28.05 15:20]
    📄 ☐   ProductController.php [28.05 13:45]
  📁 ☐ ▶ models/ (4 файла)
  📄 ☑ config.php [27.05 18:45]

Выбрано: 15 файлов
Текущий: src/controllers/UserController.php
```

## 📝 Формат выходного файла

```
# src/main.py
#!/usr/bin/env python3
import os
from pathlib import Path

def main():
    print("Hello World")

# config/settings.php
<?php
return [
    'app_name' => 'My App',
    'debug' => true
];

# api/webhook.php
<?php
// Webhook handler
echo json_encode(['status' => 'ok']);
```

## 🎯 Типичные сценарии использования

### Laravel проект
```bash
python main.py -i -t /path/to/laravel-project laravel_code.txt
```
- Выберите `app/Http/Controllers/` для контроллеров
- Отметьте `app/Models/` для моделей
- Добавьте нужные `routes/` файлы

### Анализ кодовой базы
```bash
python main.py -t /path/to/project analysis.txt
```
- Получите весь код с сортировкой по времени изменения
- Увидите последние изменения сверху

### Подготовка для AI
```bash
python main.py -i /path/to/project code_for_ai.txt
```
- Интерактивно выберите только нужные файлы
- Исключите тесты и конфиги

## 🔧 Технические детали CodeCollector

### Поддерживаемые типы файлов
- Исходный код: `.py`, `.php`, `.js`, `.html`, `.css`, `.sql`
- Конфигурация: `.json`, `.xml`, `.yml`, `.yaml`, `.ini`, `.conf`
- Документация: `.md`, `.txt`
- И многие другие текстовые форматы

### Определение текстовых файлов
CodeCollector проверяет расширения файлов и содержимое (отсутствие нулевых байтов) для определения текстовых файлов.

### Обработка кодировок
- Приоритет: UTF-8
- Fallback: CP1251 (для русских файлов)
- При ошибке: пропуск с уведомлением

## 🐛 Устранение неполадок

### Проблемы со стрелками
Если стрелки не работают, используйте альтернативы:
- **W/S** вместо ↑↓
- **J/K** (как в Vim)

### Ошибки кодировки
```
[Ошибка чтения файла: неподдерживаемая кодировка]
```
Файл будет пропущен, но обработка продолжится.

### Пустой результат
Проверьте:
- Правильность пути к проекту
- Наличие текстовых файлов
- Настройки .gitignore (возможно, исключает слишком много)

## 📈 Примеры использования

### Быстрый сбор PHP проекта
```bash
python main.py -t ~/projects/my-php-app/ php_code.txt
```

### Интерактивный выбор для React приложения
```bash
python main.py -i ~/projects/react-app/ react_components.txt
```

### Анализ Python пакета
```bash
python main.py -i -t ~/projects/my-package/ package_analysis.txt
```

## 🤝 Поддержка

Если возникли вопросы или предложения по улучшению CodeCollector, создайте issue или пишите разработчику.

## 📄 Лицензия

MIT License - используйте CodeCollector свободно для любых целей.

---
*CodeCollector создан с ❤️ для упрощения работы с кодом*